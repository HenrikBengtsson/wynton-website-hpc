<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>UCSF Wynton HPC Cluster</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="assets/css/this_site.css">
<link rel="stylesheet" href="assets/css/broadcast.css">
<link rel="stylesheet" href="assets/css/checkbox-toggle.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/ico/favicon.ico" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">UCSF Wynton HPC Cluster</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../hpc/status/index.html"> 
<span class="menu-text">Status</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-get-started" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Get Started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-get-started">    
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/access-cluster.html">
 <span class="dropdown-text">1. Login &amp; Logout</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/development-prototyping.html">
 <span class="dropdown-text">2. Development / Prototyping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/hello-world-job.html">
 <span class="dropdown-text">3. ‘Hello World’ Job</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/good-practices.html">
 <span class="dropdown-text">4. Good Practices</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/duo-signup.html">
 <span class="dropdown-text">5. 2FA Registration</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/get-started/protected-quickstart.html">
 <span class="dropdown-text">6. Wynton Protected Quickstart</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-software" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-software">    
        <li>
    <a class="dropdown-item" href="../../hpc/software/core-software.html">
 <span class="dropdown-text">Core Software</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/scl.html">
 <span class="dropdown-text">Software Collections (SCL)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/software-modules.html">
 <span class="dropdown-text">Software Modules</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/software-repositories.html">
 <span class="dropdown-text">Software Repositories</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/apptainer.html">
 <span class="dropdown-text">Linux Containers (Apptainer/Singularity)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/sbgrid.html">
 <span class="dropdown-text">SBGrid Software (restricted access)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/missing-software.html">
 <span class="dropdown-text">Missing Software?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/software/rocky-8-linux.html">
 <span class="dropdown-text">Migration to Rocky 8 Linux (Nov 2023)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sge" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">SGE</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sge">    
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/submit-jobs.html">
 <span class="dropdown-text">Submit Jobs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/list-jobs.html">
 <span class="dropdown-text">List Jobs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/kill-jobs.html">
 <span class="dropdown-text">Kill Jobs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/job-summary.html">
 <span class="dropdown-text">Job Summary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/envvars.html">
 <span class="dropdown-text">Useful Env. Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/using-local-scratch.html">
 <span class="dropdown-text">Use Local Scratch</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/queues.html">
 <span class="dropdown-text">Available Queues</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/email-notifications.html">
 <span class="dropdown-text">Job Email Notifications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/gpu.html">
 <span class="dropdown-text">GPU Scheduling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/scheduler/advanced-usage.html">
 <span class="dropdown-text">Advanced Usage</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-file-transfers" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">File Transfers</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-file-transfers">    
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/files-and-directories.html">
 <span class="dropdown-text">Secure Copy File Transfers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/globus.html">
 <span class="dropdown-text">Globus File Transfers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/globus-sharing.html">
 <span class="dropdown-text">Globus File Sharing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/ucsf-box.html">
 <span class="dropdown-text">UCSF Box</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/dos2unix.html">
 <span class="dropdown-text">Windows-Unix File Transfers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/transfers/rclone.html">
 <span class="dropdown-text">rclone (mount Wynton file system locally)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-how-to" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">How To</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-how-to">    
        <li>
    <a class="dropdown-item" href="../../hpc/howto/matlab.html">
 <span class="dropdown-text">Work with MATLAB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/python.html">
 <span class="dropdown-text">Work with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/jupyter.html">
 <span class="dropdown-text">Work with Jupyter Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/r.html">
 <span class="dropdown-text">Work with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/rstudio.html">
 <span class="dropdown-text">Work with RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/conda.html">
 <span class="dropdown-text">Work with Conda</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/conda-stage.html">
 <span class="dropdown-text">Stage Conda Environment to Local Disk</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/install-from-source.html">
 <span class="dropdown-text">Install Software from Source</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/storage-size.html">
 <span class="dropdown-text">File Sizes and Disk Quotas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/group-quota.html">
 <span class="dropdown-text">Adjust Group Disk Quota</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/find-files.html">
 <span class="dropdown-text">Find Files</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/log-in-without-pwd.html">
 <span class="dropdown-text">Log in without Password</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/change-pwd.html">
 <span class="dropdown-text">Change &amp; Verify Password</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/gui-x11fwd.html">
 <span class="dropdown-text">GUIs (X2Go &amp; X11)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/howto/jupyterhub.html">
 <span class="dropdown-text">JupyterHub Server (DISCONTINUED)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-support" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Support</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-support">    
        <li>
    <a class="dropdown-item" href="../../hpc/support/index.html">
 <span class="dropdown-text">Support Channels</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/support/faq.html">
 <span class="dropdown-text">Frequently Asked Questions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../hpc/about/specs.html">
 <span class="dropdown-text">Specifications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/gpus.html">
 <span class="dropdown-text">Available GPUs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/news.html">
 <span class="dropdown-text">News</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/pricing-storage.html">
 <span class="dropdown-text">Pricing: Extra Storage</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/pricing-compute.html">
 <span class="dropdown-text">Pricing: Extra Compute (CPU &amp; GPU)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../hpc/about/wynton-protected.html">
 <span class="dropdown-text">Wynton Protected (P3 Data)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/join.html">
 <span class="dropdown-text">Join ♡</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/shares.html">
 <span class="dropdown-text">Contributing Member Shares</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../hpc/about/governance.html">
 <span class="dropdown-text">Governance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/user-agreement.html">
 <span class="dropdown-text">User Agreement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hpc/about/citation.html">
 <span class="dropdown-text">How to Cite</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../hpc/about/contact.html">
 <span class="dropdown-text">Contact</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#submit-jobs" id="toc-submit-jobs" class="nav-link active" data-scroll-target="#submit-jobs">Submit Jobs</a>
  <ul class="collapse">
  <li><a href="#sample-submit-script" id="toc-sample-submit-script" class="nav-link" data-scroll-target="#sample-submit-script">Sample submit script</a></li>
  <li><a href="#submit-a-script-to-run-in-the-current-working-directory" id="toc-submit-a-script-to-run-in-the-current-working-directory" class="nav-link" data-scroll-target="#submit-a-script-to-run-in-the-current-working-directory">Submit a script to run in the current working directory</a></li>
  <li><a href="#specifying-maximum-memory-usage--l-mem_freeamount" id="toc-specifying-maximum-memory-usage--l-mem_freeamount" class="nav-link" data-scroll-target="#specifying-maximum-memory-usage--l-mem_freeamount">Specifying (maximum) memory usage [<code>-l mem_free=&lt;amount&gt;</code>]</a></li>
  <li><a href="#specifying-maximum-run-time--l-h_rttime" id="toc-specifying-maximum-run-time--l-h_rttime" class="nav-link" data-scroll-target="#specifying-maximum-run-time--l-h_rttime">Specifying (maximum) run time [<code>-l h_rt=&lt;time&gt;</code>]</a></li>
  <li><a href="#using-local-scratch-storage--l-scratchamount" id="toc-using-local-scratch-storage--l-scratchamount" class="nav-link" data-scroll-target="#using-local-scratch-storage--l-scratchamount">Using local scratch storage [<code>-l scratch=&lt;amount&gt;</code>]</a></li>
  <li><a href="#parallel-processing--pe-type-slots" id="toc-parallel-processing--pe-type-slots" class="nav-link" data-scroll-target="#parallel-processing--pe-type-slots">Parallel processing [<code>-pe &lt;type&gt; &lt;slots&gt;</code>]</a>
  <ul class="collapse">
  <li><a href="#single-host-parallel-processing--pe-smp-slots" id="toc-single-host-parallel-processing--pe-smp-slots" class="nav-link" data-scroll-target="#single-host-parallel-processing--pe-smp-slots">Single-host parallel processing [<code>-pe smp &lt;slots&gt;</code>]</a></li>
  <li><a href="#mpi-single-host-parallel-processing--pe-mpi_onehost-slots" id="toc-mpi-single-host-parallel-processing--pe-mpi_onehost-slots" class="nav-link" data-scroll-target="#mpi-single-host-parallel-processing--pe-mpi_onehost-slots">MPI single-host parallel processing [<code>-pe mpi_onehost &lt;slots&gt;</code>]</a></li>
  <li><a href="#mpi-multi-host-parallel-processing--pe-mpi-slots" id="toc-mpi-multi-host-parallel-processing--pe-mpi-slots" class="nav-link" data-scroll-target="#mpi-multi-host-parallel-processing--pe-mpi-slots">MPI multi-host parallel processing [<code>-pe mpi &lt;slots&gt;</code>]</a></li>
  <li><a href="#mpi-multi-threaded-multi-host-parallel-processing--pe-mpi_8-slots" id="toc-mpi-multi-threaded-multi-host-parallel-processing--pe-mpi_8-slots" class="nav-link" data-scroll-target="#mpi-multi-threaded-multi-host-parallel-processing--pe-mpi_8-slots">MPI multi-threaded multi-host parallel processing [<code>-pe mpi_8 &lt;slots&gt;</code>]</a></li>
  </ul></li>
  <li><a href="#cpu-architecture-generation--l-x86-64-vlevel" id="toc-cpu-architecture-generation--l-x86-64-vlevel" class="nav-link" data-scroll-target="#cpu-architecture-generation--l-x86-64-vlevel">CPU architecture generation [<code>-l x86-64-v=&lt;level&gt;</code>]</a></li>
  <li><a href="#minimum-network-speed-1-gbps-10-gbps-40-gbps--l-eth_speed-bandwidth" id="toc-minimum-network-speed-1-gbps-10-gbps-40-gbps--l-eth_speed-bandwidth" class="nav-link" data-scroll-target="#minimum-network-speed-1-gbps-10-gbps-40-gbps--l-eth_speed-bandwidth">Minimum network speed (1 Gbps, 10 Gbps, 40 Gbps) [<code>-l eth_speed &lt;bandwidth&gt;</code>]</a></li>
  <li><a href="#passing-arguments-to-script" id="toc-passing-arguments-to-script" class="nav-link" data-scroll-target="#passing-arguments-to-script">Passing arguments to script</a></li>
  <li><a href="#submitting-a-string-of-commands-as-job" id="toc-submitting-a-string-of-commands-as-job" class="nav-link" data-scroll-target="#submitting-a-string-of-commands-as-job">Submitting a string of commands as job</a></li>
  <li><a href="#interactive-jobs" id="toc-interactive-jobs" class="nav-link" data-scroll-target="#interactive-jobs">Interactive jobs</a></li>
  <li><a href="#tips" id="toc-tips" class="nav-link" data-scroll-target="#tips">Tips</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See also</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ucsf-wynton/wynton-website-hpc/edit/main/hpc/scheduler/submit-jobs.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ucsf-wynton/wynton-website-hpc/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="submit-jobs" class="level1">
<h1>Submit Jobs</h1>
<p>Here is what a typical job submission of shell script <code>script.sh</code> would look like from the command line:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-pe</span> smp 4 <span class="at">-l</span> mem_free=2G <span class="at">-l</span> scratch=50G <span class="at">-l</span> h_rt=00:20:00 script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This job submission will submit <code>script.sh</code> to the job scheduler which will eventually launch the job on one the compute nodes that can meet the resource needs of the job. Exactly, what these options are is explained below sections, but in summary, the above will result in:</p>
<ul>
<li><code>-S /bin/bash</code>: the job scheduler will run the script via Bash (important not to forget)</li>
<li><code>-cwd</code>: the working directory will be set to the same directory as from where the submission was done</li>
<li><code>-pe smp 4</code>: the job will be allotted four slots (“cores”) on a single machine</li>
<li><code>-l mem_free=2G</code>: the job will be allotted 2 GiB of RAM per slot, i.e.&nbsp;8 GiB in total</li>
<li><code>-l scratch=50G</code>: the job will be launched on a compute node with at least 50 GiB of local <code>/scratch</code> available</li>
<li><code>-l h_rt=00:20:00</code>: the scheduler knows that the job to run no longer than 20 minutes allowing it to be scheduled much sooner than if no run-time was specified</li>
<li><code>script.sh</code>: the shell script to be run</li>
</ul>
<section id="sample-submit-script" class="level2">
<h2 class="anchored" data-anchor-id="sample-submit-script">Sample submit script</h2>
<p>Before you can submit jobs to the compute nodes, you should prepare a script like the one below. Split your jobs into smaller tasks varying only in input parameters. You can then submit the jobs from a login node or a dev node.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash           # the shell language when run outside of the job scheduler</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                     # lines starting with #$ is an instruction to the job scheduler</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -S /bin/bash       # the shell language when run via the job scheduler [IMPORTANT]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -cwd               # job should run in the current working directory</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -j y               # STDERR and STDOUT should be joined</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -l mem_free=1G     # job requires up to 1 GiB of RAM per slot</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -l scratch=2G      # job requires up to 2 GiB of local /scratch space</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -l h_rt=24:00:00   # job requires up to 24 hours of runtime</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">##$ -t 1-10           # array job with 10 tasks (remove first '#' to enable)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -r y               # if job crashes, it should be restarted</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">## If you array jobs (option -t), this script will run T times, once per task.</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">## For each run, $SGE_TASK_ID is set to the corresponding task index (here 1-10).</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">## To configure different parameters for each task index, one can use a Bash </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">## array to map from the task index to a parameter string.</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">## All possible parameters</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># params=(1bac 2xyz 3ijk 4abc 5def 6ghi 7jkl 8mno 9pqr 10stu)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">## Select the parameter for the current task index</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">## Arrays are indexed from 0, so we subtract one from the task index</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># param="${params[$((SGE_TASK_ID - 1))]}"</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">hostname</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">## End-of-job summary, if running as a job</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="ot">-n</span> <span class="st">"</span><span class="va">$JOB_ID</span><span class="st">"</span> <span class="kw">]]</span> <span class="kw">&amp;&amp;</span> <span class="ex">qstat</span> <span class="at">-j</span> <span class="st">"</span><span class="va">$JOB_ID</span><span class="st">"</span>  <span class="co"># This is useful for debugging and usage purposes,</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="co"># e.g. "did my job exceed its memory request?"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="submit-a-script-to-run-in-the-current-working-directory" class="level2">
<h2 class="anchored" data-anchor-id="submit-a-script-to-run-in-the-current-working-directory">Submit a script to run in the current working directory</h2>
<p>To submit a shell script to the scheduler such that it will run in the current working directory (<code>-cwd</code>), use:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The scheduler will assign your job a unique (numeric) job ID.</p>
</section>
<section id="specifying-maximum-memory-usage--l-mem_freeamount" class="level2">
<h2 class="anchored" data-anchor-id="specifying-maximum-memory-usage--l-mem_freeamount">Specifying (maximum) memory usage [<code>-l mem_free=&lt;amount&gt;</code>]</h2>
<p>Unless specified, the maximum amount of memory used at any time is 1 GiB per slot (<code>-l mem_free=1G</code>). A job that need to use more memory, need to request that when submitted. For example, a job that needs (at most) 10 GiB of memory should be submitted as:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> mem_free=10G script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The scheduler will launch this jobs on the first available compute node with that amount of memory available.</p>
<p><em>TIPS</em>: Add <code>qstat -j $JOB_ID</code> to the end of your script to find out how much memory and CPU time your job needed. See <a href="../../hpc/scheduler/job-summary.html">Job Summary</a> page for more details.</p>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>A job that consumes more memory than requested may be terminated by the administrators and in the future possibly automatically by the scheduler. Because of this, you may request a bit more memory in order to give your job some leeway.</p>
</div>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>Note that <code>-l mem_free=size</code> specifies <em>memory per slot</em>, not per job.</p>
</div>
</section>
<section id="specifying-maximum-run-time--l-h_rttime" class="level2">
<h2 class="anchored" data-anchor-id="specifying-maximum-run-time--l-h_rttime">Specifying (maximum) run time [<code>-l h_rt=&lt;time&gt;</code>]</h2>
<div class="alert alert-info" role="alert" data-markdown="1">
<p>Specifying the run time will shorten the queuing time - significantly so for short running jobs.</p>
</div>
<p>By specifying the how long each job will take, the better the scheduler can manage resources and allocate jobs to different nodes. This will also decrease the average waiting time the job will sit in the queue before being launched on a compute node. You can specify the maximum run time (= wall time, not CPU time) for a job using option <code>-l h_rt=HH:MM:SS</code> where <code>HH:MM:SS</code> specifies the number of hours (<code>HH</code>), the number of minutes (<code>MM</code>), and the number of seconds (<code>SS</code>) - all parts must be specified. For instance, the following job is expected to run for at most 3 minutes (180 seconds):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> mem_free=2G <span class="at">-l</span> h_rt=00:03:00 script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>If not specified, the default run time is 14 days, i.e.&nbsp;the maximum allowed. If your job will run more quickly than that, a more accurate estimate will help the scheduler plan better. Note, though, that jobs are killed if they hit the run time request, so be sure to leave some leeway in your request.</p>
</div>
</section>
<section id="using-local-scratch-storage--l-scratchamount" class="level2">
<h2 class="anchored" data-anchor-id="using-local-scratch-storage--l-scratchamount">Using local scratch storage [<code>-l scratch=&lt;amount&gt;</code>]</h2>
<p>Each compute node has {{ site.data.specs.local_scratch_size_min }}-{{ site.data.specs.local_scratch_size_max }} TiB of <a href="../../hpc/about/specs.html#scratch-storage">local scratch storage</a> which is fast and ideal for temporary, intermediate data files that are only needed for the length of a job. This scratch storage is unique to each machine and shared among all users and jobs running on the same machine. To minimize the risk of launching a job on a node that have little scratch space left, specify the <code>-l scratch=size</code> resource. For instance, if your job requires 200 GiB of local <code>/scratch</code> space, submit the job using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> scratch=200G script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Your job is only guaranteed the amount of available scratch space that you request <em>when it is launched</em>. For more information and best practices, see <a href="../../hpc/scheduler/using-local-scratch.html">Using Local /scratch on Compute Nodes</a>.</p>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>Please specify <code>-l scratch=size</code> when using local <code>/scratch</code> and please <a href="using-local-scratch.html">clean up afterward</a>. This maximizes the chance for compute nodes having enough available space, reduces the queuing times, and minimizes the risk for running out of local scratch.</p>
</div>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>Note that <code>-l scratch=size</code> specifies <em>space per job</em>, not per slot.</p>
</div>
<p>If your job would benefit from extra-fast <a href="../../hpc/about/specs.html#scratch-storage">local scratch storage</a>, then you can request a node with either a SSD or NVMe scratch drive via the following flag:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-l</span> ssd_scratch=1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="parallel-processing--pe-type-slots" class="level2">
<h2 class="anchored" data-anchor-id="parallel-processing--pe-type-slots">Parallel processing [<code>-pe &lt;type&gt; &lt;slots&gt;</code>]</h2>
<p>By default, the scheduler will allocate a single core for your job. To allow the job to use multiple CPU cores, you must run your job in a SGE parallel environment (PE) and tell SGE how many cores the job will use. Please note that jobs using multiple cores running outside of a parallel environment are subject to termination without warning by the Wynton admins. There are four parallel environments on Wynton:</p>
<ul>
<li><code>smp</code>: for single-host parallel jobs using <a href="https://en.wikipedia.org/wiki/Symmetric_multiprocessing">‘Symmetric multiprocessing (SMP)’</a></li>
<li><code>mpi</code>: for multiple-host parallel jobs based on MPI parallelization</li>
<li><code>mpi_onehost</code>: for single-host parallel jobs based on MPI parallelization</li>
<li><code>mpi-8</code>: for multi-threaded multi-host jobs based on MPI parallelization</li>
</ul>
<p>For any of the above environments, you must request the number of slots needed when you submit the job, e.g.&nbsp;<code>-pe smp 4</code>, <code>-pe mpi_onehost 14</code>, <code>-pe mpi 38</code>, and <code>-pe mpi-8 40</code>.</p>
<section id="single-host-parallel-processing--pe-smp-slots" class="level3">
<h3 class="anchored" data-anchor-id="single-host-parallel-processing--pe-smp-slots">Single-host parallel processing [<code>-pe smp &lt;slots&gt;</code>]</h3>
<p>To request four slots (<code>NSLOTS=4</code>) on a single host, where <em>each slot gets 2 GiB of RAM</em>, for a <em>total</em> of 8 GiB RAM, use:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-pe</span> smp 4 <span class="at">-l</span> mem_free=2G script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The scheduler will make sure your job is launched on a node with at least four slots available.</p>
<p>Note, when writing your script, use SGE environment variable <code>NSLOTS</code>, which is set to the number of cores that your job was allocated. This way you don’t have to update your script if you request a different number of cores. For instance, if your script runs the BWA alignment, have it specify the number of parallel threads as:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bwa</span> aln <span class="at">-t</span> <span class="st">"</span><span class="va">${NSLOTS</span><span class="op">:-</span>1<span class="va">}</span><span class="st">"</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By using <code>${NSLOTS:-1}</code>, instead of just <code>${NSLOTS}</code>, this script will fall back to use a single thread if <code>NSLOTS</code> is not set, e.g.&nbsp;when running the script on your local computer.</p>
<div class="alert alert-danger" role="alert" data-markdown="1">
<p><strong>Do not use more cores than requested!</strong> - a common reason for compute nodes being clogged up and jobs running slowly. A typically mistake is to hard-code the number of cores in the script and then request a different number when submitting the job - using <code>NSLOTS</code> avoids this problem. Another problem is software that by default use all of the machine’s cores - make sure to control for this, e.g.&nbsp;use dedicated command-line option or environment variable for that software. One such environment variable is <code>OMP_NUM_THREADS</code>. For bash scripts, use <code>export OMP_NUM_THREADS=${NSLOTS:-1}</code>.</p>
</div>
</section>
<section id="mpi-single-host-parallel-processing--pe-mpi_onehost-slots" class="level3">
<h3 class="anchored" data-anchor-id="mpi-single-host-parallel-processing--pe-mpi_onehost-slots">MPI single-host parallel processing [<code>-pe mpi_onehost &lt;slots&gt;</code>]</h3>
<p>Similarly to the SMP parallel environment, we can request slots on a single host for the main purpose of using MPI to orchestrate the parallel processing. For example, to request ten such slots, use:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-pe</span> mpi_onehost 10 <span class="at">-l</span> mem_free=2G script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where the job script looks like something like:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -S /bin/bash       # the shell language when run via the job scheduler [IMPORTANT]</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -cwd               # job should run in the current working directory</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load mpi/openmpi-x86_64</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Important: Make sure to $NHOSTS here</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="ex">mpirun</span> <span class="at">-np</span> <span class="va">$NSLOTS</span> /path/to/the_app</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="mpi-multi-host-parallel-processing--pe-mpi-slots" class="level3">
<h3 class="anchored" data-anchor-id="mpi-multi-host-parallel-processing--pe-mpi-slots">MPI multi-host parallel processing [<code>-pe mpi &lt;slots&gt;</code>]</h3>
<p>MPI supports parallelization across multiple hosts where the different parallel processes communicating over the network. To request a, possible, multi-host job, use <code>-pi mpi &lt;slots&gt;</code>. For example,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-pe</span> mpi 24 <span class="at">-l</span> mem_free=2G script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>requests 24 slots, each allotted 2 GiB RAM, with a total of 48 GiB RAM.</p>
</section>
<section id="mpi-multi-threaded-multi-host-parallel-processing--pe-mpi_8-slots" class="level3">
<h3 class="anchored" data-anchor-id="mpi-multi-threaded-multi-host-parallel-processing--pe-mpi_8-slots">MPI multi-threaded multi-host parallel processing [<code>-pe mpi_8 &lt;slots&gt;</code>]</h3>
<p>In addition to <code>-pe mpi_onehost &lt;nslots&gt;</code> and <code>-pe mpi &lt;nslots&gt;</code>, Wynton HPC provides a special MPI parallel environment (PE) called <code>mpi-8</code> that allocates exactly eight (8) slots per node <em>across one or more compute nodes</em>. For instance, to request a Hybrid MPI job with in total forty slots (40), submit it as:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-pe</span> mpi-8 40 hybrid_mpi.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and make sure that the script (here <code>hybrid_mpi.sh</code>) exports <code>OMP_NUM_THREADS=8</code> (the eight slots per node) and then launches the MPI application using <code>mpirun -np $(wc -l &lt; "$PE_HOSTFILE") /path/to/the_app</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -S /bin/bash       # the shell language when run via the job scheduler [IMPORTANT]</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#$ -cwd               # job should run in the current working directory</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load mpi/openmpi-x86_64</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">OMP_NUM_THREADS</span><span class="op">=</span>8</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Important: Don't use -np $NHOSTS here</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="ex">mpirun</span> <span class="at">-np</span> <span class="va">$(</span><span class="fu">wc</span> <span class="at">-l</span> <span class="op">&lt;</span> <span class="st">"</span><span class="va">$PE_HOSTFILE</span><span class="st">"</span><span class="va">)</span> /path/to/the_app</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--
To request a job where all MPI tasks run on the same machine, use: 

```sh
qsub -pe mpi_onehost 40 hybrid_mpi.sh
```
-->
<p><em>Note</em>: When working with MPI, it is important to use the exact same version as was used to built the software using MPI. Because of this, we always specify the full <code>mpi/&lt;version&gt;</code> path.</p>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>Note that mpi-8 jobs must request a multiple of exactly eight (8) slots. If <code>NSLOTS</code> is not a multiple of eight, then the job will be stuck in the queue forever and never run.</p>
</div>
<div class="alert alert-warning" role="alert" data-markdown="1">
<p>2023-01-23: Due to an SGE issue, you <em>must not</em> use <code>NHOSTS</code> as in <code>mpirun -np $NHOSTS ...</code>. If done, you might overuse one node and underuse another, when requesting 16 or more slots. Until resolved, please use the <code>mpirun -np $(wc -l &lt; "$PE_HOSTFILE") ...</code> solution instead.</p>
</div>
</section>
</section>
<section id="cpu-architecture-generation--l-x86-64-vlevel" class="level2">
<h2 class="anchored" data-anchor-id="cpu-architecture-generation--l-x86-64-vlevel">CPU architecture generation [<code>-l x86-64-v=&lt;level&gt;</code>]</h2>
<p>All Wynton HPC compute nodes have x86-64-compliant CPUs, but they differ in generation. There are four major generations of CPUs - x86-64-v1, x86-64-v2, x86-64-v3, and x86-64-v4 - formally referred to as <a href="https://en.wikipedia.org/wiki/X86-64#Microarchitecture_levels">CPU microarchitecture levels</a>. Most software tools are compiled such they can run on any of these generations, that is, they only require a CPU supporting x86-64-v1. However, some are compiled to take advantage of more modern CPU instructions, and thereby become more performant. Such software tools cannot run on an older generation of CPUs. For example, if a tool uses x86-64-v4 CPU instructions, but is launched on a x86-64-v3 machine, it will terminate, often with an obscure error, e.g.</p>
<pre class="plain"><code> *** caught illegal operation ***
address 0x2b3a8b234ccd, cause 'illegal operand'</code></pre>
<p>or</p>
<pre class="plain"><code>Illegal instruction (core dumped)</code></pre>
<p>If you have a software tool that requires a specific x86-64 level, specify it via the <code>x86-64-v=&lt;level&gt;</code> resource. For example,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> x86-64-v=3 script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will launch the job on a compute node with x86-64-v3 CPUs or newer.</p>
</section>
<section id="minimum-network-speed-1-gbps-10-gbps-40-gbps--l-eth_speed-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="minimum-network-speed-1-gbps-10-gbps-40-gbps--l-eth_speed-bandwidth">Minimum network speed (1 Gbps, 10 Gbps, 40 Gbps) [<code>-l eth_speed &lt;bandwidth&gt;</code>]</h2>
<p>The majority of the compute nodes have 1 Gbps and 10 Gbps network cards while a few got 40 Gbps cards. A job that requires 10-40 Gbps network speed can request this by specifying the <code>eth_speed=10</code> (sic!) resource, e.g.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> eth_speed=10 script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A job requesting <code>eth_speed=40</code> will end up on a 40 Gbps node, and a job requesting <code>eth_speed=1</code> (default) will end up on any node.</p>
</section>
<section id="passing-arguments-to-script" class="level2">
<h2 class="anchored" data-anchor-id="passing-arguments-to-script">Passing arguments to script</h2>
<p>You can pass arguments to a job script similarly to how one passes argument to a script executed on the command line, e.g.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">qsub</span> <span class="at">-cwd</span> <span class="at">-l</span> mem_free=1G script.sh <span class="at">--first</span><span class="op">=</span>2 <span class="at">--second</span><span class="op">=</span>true <span class="at">--third</span><span class="op">=</span><span class="st">'"some value"'</span> <span class="at">--debug</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Arguments are then passed as if you called the script as <code>script.sh --first=2 --second=true --third="some value" --debug</code>. Note how you have to have an extra layer of single quotes around <code>"some value"</code>, otherwise <code>script.sh</code> will see <code>--third=some value</code> as two independent arguments (<code>--third=some</code> and <code>value</code>).</p>
</section>
<section id="submitting-a-string-of-commands-as-job" class="level2">
<h2 class="anchored" data-anchor-id="submitting-a-string-of-commands-as-job">Submitting a string of commands as job</h2>
<p>The <code>qsub</code> command typically takes a job-script file as input, but, alternatively, it can take a sequence of commands on the standard input (stdin) as input. For example, consider you want to run two commands via the job scheduler;</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hostname</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> <span class="at">--iso-8601</span><span class="op">=</span>seconds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Instead of creating a script file with those two commands, you can pass them to <code>sub</code> using <code>echo</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"hostname; date --iso-8601=seconds"</span> <span class="kw">|</span> <span class="ex">qsub</span> <span class="at">-S</span> /bin/bash <span class="at">-cwd</span> <span class="at">-l</span> mem_free=1G</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Your</span> job 2225213 <span class="er">(</span><span class="st">"STDIN"</span><span class="kw">)</span> <span class="ex">has</span> been submitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="interactive-jobs" class="level2">
<h2 class="anchored" data-anchor-id="interactive-jobs">Interactive jobs</h2>
<p>It is currently <em>not</em> possible to request <em>interactive</em> jobs (aka <code>qlogin</code>). Instead, there are dedicated <a href="../../hpc/get-started/development-prototyping.html">development nodes</a> that can be used for short-term interactive development needs such building software and prototyping scripts before submitting them to the scheduler.</p>
<p><em>Comment</em>: MPI stands for <a href="https://en.wikipedia.org/wiki/Message_Passing_Interface">‘Message Passing Interface’</a>.</p>
</section>
<section id="tips" class="level2">
<h2 class="anchored" data-anchor-id="tips">Tips</h2>
<ul>
<li>An array job is a collection of similar serial jobs which can be submitted and controlled together. For example, <code>-t 1-10</code> runs 10 tasks in an array. Each task runs the same script, but gets a different value for the <code>$SGE_TASK_ID</code> environment variable (from ‘1’ to ‘10’ in this example). You can use this to choose different inputs or other parameters for each task.</li>
<li>The SGE manual pages are installed on the login and dev nodes. For more info on any SGE command, just type the name of command (e.g., <code>man qsub</code>).</li>
</ul>
<!--
## Defaults

* Memory usage (per slot): If not specified, the default is `-l mem_free=1G`.

* Working directory: If not specified (e.g. `-cwd`), the default working directory is `$HOME`.
-->
</section>
<section id="see-also" class="level2">
<h2 class="anchored" data-anchor-id="see-also">See also</h2>
<p>For further options and advanced usage, see <a href="../../hpc/scheduler/advanced-usage.html">Advanced Usage</a> of the scheduler.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/wynton\.ucsf\.edu\/hpc\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.ucsf.edu/">UCSF</a> :: <a href="https://wynton.ucsf.edu/">Wynton</a> :: <a href="../../hpc/">Wynton HPC</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ucsf-wynton/wynton-website-hpc/edit/main/hpc/scheduler/submit-jobs.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ucsf-wynton/wynton-website-hpc/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>&lt;a href=“<strong>?meta:repo-url</strong>/commits/master/docs/<strong>?meta:source-file</strong>”&gt;Change log :: &lt;a href=“<strong>?meta:repo-url</strong>/tree/master/docs/<strong>?meta:source-file</strong>”&gt;Contribute</p>
</div>
  </div>
</footer>




</body></html>